<html>
    <head>
            <link href="{{url_for('static',filename='css/dashboard.css')}}" rel="stylesheet">
            <link href="{{url_for('static', filename='css/dataTables.bootstrap.min.css')}}  " rel="stylesheet">
            <link href="{{url_for('static',filename='css/print.min.css')}}" rel="stylesheet">
            <link href="{{url_for('static', filename='css/bootstrap.min.css')}}" rel="stylesheet">
            <link href="{{url_for('static', filename='css/printstyles.css')}}" rel="stylesheet" media="print">
        <style>
           
            body{
                margin-top: 15px;
                margin-left: 5px;
                margin-right: 5px;

            }
            thead {display: table-header-group;}
            tfoot {display: table-header-group;}

           
            
           
        </style>
        </style>
    </head>
    <body>
        <div class="container-fulid P-1">   
                <div class="printclass">
                        <div id="header" class="text-center">
                            <h5 class="mb-0">Siddhi Vinayak Knots and Prints Pvt. Ltd.</h5>
                            <p class=" mb-0 text-monospace text-muted">A-26 To A-32, "Central Park", G.I.D.C Pandesra, SURAT-394221.
                                </p>
                                <h5 class="mb-0 mt-2">{{title}}</h5>
                        </div>
                        {% if title == 'Visitor Records' %}
                        <div class="mr-2 mb-2 row">
                             <div class="text-right ml-4">
                                    <strong> Date: {{date.strftime('%d/%m/%Y')}}</strong>
                            </div>
                            <div class="col text-right">
                                   <strong >Total Count:<span class="ml-2">{{count}}
                                    </strong>
                            </div>
                        </div>
                        <div id='tableclass' class="m">
                            <table class="mb-4 table table-sm table-bordered">
                                <thead >
                                    <tr class="text-center">
                                        <th>#</th>
                                        <th>Visitor Name</th>
                                        <th>Contact No</th>
                                        <th>Company/From</th>
                                        <th>Visiting Employee</th>
                                        <th>Visiting Department</th>
                                        <th>Visiting Purpose</th>
                                        <th>In Time</th>
                                        <th> Out Time </th>
                                        <th>Total Duration </th>
                                    </tr>
                                </thead>
                                
                                <tbody>
                                    {% for vi in query |groupby('active.visited_dept.department_name') %}
                                     <tr>
                                            <td></td>
                                            
                                            <td>{{vi.a_timelog.name.title()}}</td>
                                            <td>{{vi.a_timelog.contact}}</td>
                                            <td>{{vi.a_timelog.place_from.title()}}</td>
                                            {% if vi.active.visited_employee     == None %}
                                            <td></td>
                                            {% else %}
                                            <td> {{vi.active.visited_employee.employee_name.title()}} </td>
                                            {% endif %}


                                            {% if vi.a_timelog.visiting_department == None   %}
                                            <td>None</td>
                                            {% else %}
                                            <td>{{vi.active.visited_dept.department_name.title()}}</td>
                                            {% endif %}


                                            <td> {{vi.active.visiting_purpose.title()}}</td>
                                            <td>{{vi.in_time.strftime('%H:%M')}}</td>


                                            {% if vi.out_time == None %}
                                            <td></td>
                                            {% else %}
                                            <td>{{vi.out_time.strftime('%H:%M')}}</td>
                                            {% endif %}


                                            {% if vi.duration == None %}
                                            <td></td>
                                            {% else %}
                                            <td>{{vi.duration}}</td>
                                            {% endif %}


                                    </tr>
                                    {% endfor %}    
                                </tbody>
                            </table>
                        </div>
                        {% endif %}

            {% if title == 'Visitors Records by Department' %}
                        <div class="mr-2 row mb-3 border-bottom ml-2">
                            <div class=" col">
                                    <strong>Department: {{department.department_name}} </strong> 
                            </div>
                            <div class="col-2 text-right mr-n5">
                                    <strong> Date: {{date.strftime('%d/%m/%Y')}}</strong>
                            </div>
                            <div class="col-2 text-right">
                                   <strong >Total Count:<span class="ml-2">{{count}}
                                    </strong>
                            </div>
                             
                            
                            
                    </div> 
                        <div id='tableclass' class="">
                            <table class="table table-sm table-bordered">
                                <thead >
                                    <tr class="text-center">
                                        <th>#</th>
                                        <th>Visitor Name</th>
                                        <th>Contact No</th>
                                        <th>Company/From</th>
                                        <th>Visiting Employee</th>
                                        <th>Visiting Purpose</th>
                                        <th>In Time</th>
                                        <th> Out Time </th>
                                        <th>Total Duration </th>
                                    </tr>
                                </thead>
                                
                                <tbody>
                                    {% for vi in filtered_list %}
                                     <tr>
                                            <td></td>
                                            <td>{{vi.a_timelog.name.title()}}</td>
                                            <td>{{vi.a_timelog.contact}}</td>
                                            <td>{{vi.a_timelog.place_from.title()}}</td>
                                            {% if vi.active.visited_employee     == None %}
                                            <td>None</td>
                                            {% else %}
                                            <td> {{vi.active.visited_employee.employee_name.title()}} </td>
                                            {% endif %}

                                            <td> {{vi.active.visiting_purpose.title()}}</td>


                                            {% if vi.in_time == None %}
                                            <td></td>
                                            {% else %}
                                            <td>{{vi.in_time.strftime('%H:%M')}}</td>
                                            {% endif %}


                                            {% if vi.out_time == None %}
                                            <td></td>
                                            {% else %}
                                            <td>{{vi.out_time.strftime('%H:%M')}}</td>
                                            {% endif %}
                                            <td>{{vi.duration}}</td>
                                    </tr>
                                    {% endfor %}    
                                </tbody>
                            </table>
                        </div>
                        {% endif %}

                        {% if title == 'Visitor Records Sorted by Employee Visited' %}
                        <div class="mr-2 mb-2 row">
                             <div class="text-right ml-4">
                                    <strong> Date: {{date.strftime('%d/%m/%Y')}}</strong>
                            </div>
                            <div class="col text-right">
                                   <strong >Total Count:<span class="ml-2">{{count}}
                                    </strong>
                            </div>
                        </div>
                        <div id='tableclass' class="m">
                            <table class="mb-4 table table-sm table-bordered">
                                <thead >
                                    <tr class="text-center">
                                        <th>#</th>
                                        <th>Visitor Name</th>
                                        <th>Contact No</th>
                                        <th>Company/From</th>
                                        <th>Visiting Employee</th>
                                        <th>Visiting Department</th>
                                        <th>Visiting Purpose</th>
                                        <th>In Time</th>
                                        <th> Out Time </th>
                                        <th>Total Duration </th>
                                    </tr>
                                </thead>
                                
                                <tbody>
                                    {% for vi in query | sort(attribute='active.visited_employee.employee_name') %}
                                     <tr>
                                            <td></td>
                                            <td>{{vi.a_timelog.name.title()}}</td>
                                            <td>{{vi.a_timelog.contact}}</td>
                                            <td>{{vi.a_timelog.place_from.title()}}</td>
                                            {% if vi.active.visited_employee     == None %}
                                            <td>None</td>
                                            {% else %}
                                            <td> {{vi.active.visited_employee.employee_name.title()}} </td>
                                            {% endif %}


                                            {% if vi.a_timelog.visiting_department == None   %}
                                            <td>None</td>
                                            {% else %}
                                            <td>{{vi.active.visited_dept.department_name.title()}}</td>
                                            {% endif %}


                                            <td> {{vi.active.visiting_purpose.title()}}</td>
                                            {% if vi.in_time == None %}
                                            <td></td>
                                            {% else %}
                                            <td>{{vi.in_time.strftime('%H:%M')}}</td>
                                            {% endif %}


                                            {% if vi.out_time == None %}
                                            <td></td>
                                            {% else %}
                                            <td>{{vi.out_time.strftime('%H:%M')}}</td>
                                            {% endif %}


                                            <td>{{vi.duration}}</td>
                                    </tr>
                                    {% endfor %}    
                                </tbody>
                            </table>
                        </div>
                        {% endif %}


                        {% if title == 'Visitor Records Sorted by Department' %}
                        <div class="mr-2 mb-2 row">
                             <div class="text-right ml-4">
                                    <strong> Date: {{date.strftime('%d/%m/%Y')}}</strong>
                            </div>
                            <div class="col text-right">
                                   <strong >Total Count:<span class="ml-2">{{count}}
                                    </strong>
                            </div>
                        </div>
                        <div id='tableclass' class="m">
                            <table class="mb-4 table table-sm table-bordered">
                                <thead >
                                    <tr class="text-center">
                                        <th>#</th>
                                        <th>Visitor Name</th>
                                        <th>Contact No</th>
                                        <th>Company/From</th>
                                        <th>Visiting Employee</th>
                                        <th>Visiting Department</th>
                                        <th>Visiting Purpose</th>
                                        <th>In Time</th>
                                        <th> Out Time </th>
                                        <th>Total Duration </th>
                                    </tr>
                                </thead>
                                
                                <tbody>
                                    {% for vi in query | sort(attribute='active.visited_dept.department_name') %}
                                       
                                     <tr>
                                           
                                            <td></td>
                                            <td>{{vi.a_timelog.name.title()}}</td>
                                            <td>{{vi.a_timelog.contact}}</td>
                                            <td>{{vi.a_timelog.place_from.title()}}</td>
                                            {% if vi.active.visited_employee     == None %}
                                            <td>None</td>
                                            {% else %}
                                            <td> {{vi.active.visited_employee.employee_name.title()}} </td>
                                            {% endif %}


                                            {% if vi.a_timelog.visiting_department == None   %}
                                            <td>None</td>
                                            {% else %}
                                            <td>{{vi.active.visited_dept.department_name.title()}}</td>
                                            {% endif %}


                                            <td> {{vi.active.visiting_purpose.title()}}</td>
                                            {% if vi.in_time == None %}
                                            <td></td>
                                            {% else %}
                                            <td>{{vi.in_time.strftime('%H:%M')}}</td>
                                            {% endif %}


                                            {% if vi.out_time == None %}
                                            <td></td>
                                            {% else %}
                                            <td>{{vi.out_time.strftime('%H:%M')}}</td>
                                            {% endif %}


                                            <td>{{vi.duration}}</td>
                                    </tr>
                                    {% endfor %}    
                                </tbody>
                            </table>
                        </div>
                        {% endif %}
                    </div>
        </div>
        <script src="{{url_for('static', filename='js/jquery-3.4.js')}}"></script>
    </body>

    
<script type="text/javascript">
    var addSerialNumber = function(){
        $('table tr').each(function(index){
            $(this).find('td:nth-child(1)').html(index+0);
        });
    };
    
    addSerialNumber();
</script>


</html>